We are pleased to announce the release of OpenQuake 1.9. This is a
major release and contains numerous improvements with respect to
OpenQuake 1.8. Everybody is invited to upgrade, by following the usual
procedure.


New features of the OpenQuake Engine, version 1.9
-------------------------------------------------

1. The most important thing is that we removed the dependency from
PostGIS. Right now the engine uses only four relational tables; the
plan for the future (for release 2.0) is to remove PostgreSQL entirely
and to use sqlite as internal database. This is possible since after
the changes in engine 1.8 all of the calculation data are stored in an
HDF5 file, and only a minimal amount of data is stored in the relation
tables: we just store the job ID, the start time and stop time, the
path to the underlying HDF5 file, some logs and some performance
information.  The change is compatible with the past and will not
affect your existing tables if you are upgrading from a previous
version.

2. The memory occupation and data transfer of the event based risk calculation
have been improved since now the asset loss table by default is not built.
Moreover, the insured losses are trasferred and stored only when the flag
`insured_losses` is true. Before, `NaNs` were transferred and stored.

3. Secondly, we have introduced several new CSV exporters.
Such exporters are not documented in the manual yet, but they
will. Here is the list of the official CSV exporters:

  - an exporter for scenario ground motion fields
  - an exporter for loss maps, working consistently for classical_risk,
    event_based_risk and scenario_risk calculations
  - an exporter for scenario damage distribution by asset
  - an exporter for scenario damage distribution by taxonomy
  - an exporter for scenario damage distribution total

4. There is not GMF CSV exporter for event based calculations:
this is on purpose, since exporting all of the GMFs
would easily take longer that the whole computation. You can export the GMFs
generated by specific ruptures with oq-lite, but this feature is still
experimental and undocumented.

5. The XML exporters have been improved too. Now the loss curve and loss map
exporters export both the hazard investigation time and the risk investigation
time.

7. More pickled objects have been replaced by proper arrays in the datastore:
in particular the `CostCalculator` object and the `time_events` list.

8. When exporting a multiple output, the engine prints the path names of
all the exported files. Before, it was just printing the export directory.

Bug fixes
-------------------------

1. In release 1.8 some risk calculations were incorrectly flagged as hazard
calculations; this has been fixed by looking directly at the
`calculation_mode` parameter.

2. In release 1.8 there was an error in the event based risk
calculator when trying to compute the statistics of loss maps in
absence of `conditional_loss_poes`: now there is no error, the statistics
are just not computed, because there are no loss maps.

3. When reading a datastore, the engine correctly discriminates between
the "file not found" and "no permission" errors. Before,
you got a "file not found" error even if the file existed but you had
to permission to traverse the containing directories.

4. If the job description contained a non-ASCII character, the .rst
report could not be generated. This has been fixed.

5. In engine 1.8 in some situations the lines of logs on `stderr` were
duplicated. Moreover the logs were no ordered chronologically in the WebUI.
Both issues have been fixed.

6. The default job status has changed from `pre_executing` to `executing`.
This reads better in the Web UI.

7. We removed a misleading error message referring to the obsolete option
`--hazard-output-id` that was removed in release 1.8.
